<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Terminal</title>
  <!-- PWA refs -->
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#32cd32">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data:; script-src 'self' https://apis.google.com; style-src 'self';"/>
  <script src="dompurify.js"></script>
  <script src="sanitize.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="header">
    <div class="left">
      <div class="title">TERMINAL<span class="cursor"></span></div>
      <div class="subtitle">Type HELP to begin</div>
    </div>
    <div id="installWrap">
      <span id="installStatus" class="muted"></span>
      <button id="installBtn" aria-label="Install app">Install</button>
    </div>
  </div>

  <div id="output" role="log" aria-live="polite"></div>

  <div id="input-bar" role="group" aria-label="Command input">
    <span id="prompt-label">&gt; </span>
    <input id="command" name="command" type="text" inputmode="text" autocapitalize="sentences"
           spellcheck="true" placeholder="enter command..." autocomplete="off" />

  </div>

  <div id="modal" role="dialog" aria-modal="true" aria-labelledby="wipe-title">
    <div class="card">
      <div id="wipe-title" class="line">Confirm WIPE</div>
      <div class="line mt-6">Are you sure you want to WIPE all data?</div>
      <div class="row">
        <button class="terminal" id="btn-cancel">Cancel</button>
        <button class="terminal" id="btn-confirm">WIPE</button>
      </div>
    </div>
  </div>

  <div id="note-modal" role="dialog" aria-modal="true" aria-labelledby="note-modal-title">
    <div class="card">
      <div id="note-modal-title" class="line">Add Note</div>
      <label for="note-title" class="line">Title</label>
      <input id="note-title" type="text" />
      <label for="note-description" class="line">Description</label>
      <textarea id="note-description" rows="2"></textarea>
      <label for="note-links" class="line">Links</label>
      <input id="note-links" type="text" />
      <label for="note-attachments" class="line">Attachments</label>
      <input id="note-attachments" type="text" />
      <input id="note-attachments-files" type="file" accept="image/*" multiple />
      <div id="note-attachments-preview" class="line"></div>
      <label for="note-body" class="line">Body</label>
      <textarea id="note-body" rows="4"></textarea>
      <div class="row">
        <button class="terminal" id="note-cancel">Cancel</button>
        <button class="terminal" id="note-save">Save</button>
      </div>
    </div>
  </div>

  <div id="msg-modal" role="dialog" aria-modal="true" aria-labelledby="msg-modal-title">
    <div class="card">
      <div id="msg-modal-title" class="line">Send Message</div>
      <label for="msg-from" class="line">From</label>
      <input id="msg-from" type="text" />
      <label for="msg-to" class="line">To</label>
      <input id="msg-to" type="text" />
      <label for="msg-subject" class="line">Subject</label>
      <input id="msg-subject" type="text" />
      <label for="msg-date" class="line">Date</label>
      <input id="msg-date" type="text" readonly />
      <label for="msg-time" class="line">Time</label>
      <input id="msg-time" type="text" readonly />
      <label for="msg-body" class="line">Message</label>
      <textarea id="msg-body" rows="4"></textarea>
      <label for="msg-pass" class="line">Passcode</label>
      <input id="msg-pass" type="password" />
      <div class="row">
        <button class="terminal" id="msg-cancel">Cancel</button>
        <button class="terminal" id="msg-share">Share</button>
      </div>
    </div>
  </div>

  <div id="pic-modal" role="dialog" aria-modal="true" aria-labelledby="pic-modal-title">
    <div class="card">
      <div id="pic-modal-title" class="line">Image Preview</div>
      <div class="line text-center mt-6">
        <img id="pic-modal-img" alt="note image" />
      </div>
      <div class="row">
        <button class="terminal" id="pic-close">Close</button>
      </div>
    </div>
  </div>

  <div id="install-help" role="dialog" aria-modal="true" aria-labelledby="install-title">
    <div class="card">
      <div id="install-title" class="line">Install Help</div>
      <div class="line mt-6">
        The browser didn’t expose the install prompt yet.
      </div>
      <div class="line mt-6">
          Ensure: <code>manifest.webmanifest</code> (with 192/512 icons) is reachable, a <code>sw.js</code> is registered and controlling this page, and you’re on HTTPS or localhost.
      </div>
      <div class="line mt-6">
        iOS Safari: use Share → “Add to Home Screen” (no programmatic prompt on iOS).
      </div>
      <div class="row">
        <button class="terminal" id="install-close">Close</button>
      </div>
    </div>
  </div>
  
  <!-- Update hash: curl -s https://apis.google.com/js/api.js | openssl dgst -sha384 -binary | openssl base64 -A -->
  <script src="https://apis.google.com/js/api.js" integrity="sha384-OLBgp1GsljhM2TJ+sbHjaiH9txEUvgdDTAzHv2P24donTt6/529l+9Ua0vFImLlb" crossorigin="anonymous"></script>

  <script type="module" src="app.js"></script>
</body>
</html>
